category: ENVOY
lookups:
  - entityTypes:
      - domain: EXT
        type: ENVOY
    tags:
      matchingMode: ALL
      predicates:
        - tagKeys: ["cluster_name"]
          field: k8s.clusterName
        - tagKeys: ["namespace"]
          field: k8s.namespaceName
        - tagKeys: ["pod"]
          field: k8s.podName
    onMatch:
      onMultipleMatches: RELATE_ALL
    onMiss:
      action: NO_OP
  - entityTypes:
      - domain: EXT
        type: ENVOY
    tags:
      matchingMode: ALL
      predicates:
        - tagKeys: ["k8s.cluster.name"]
          field: k8s.clusterName
        - tagKeys: ["k8s.namespace.name"]
          field: k8s.namespaceName
        - tagKeys: ["k8s.pod.name"]
          field: k8s.podName
    onMatch:
      onMultipleMatches: RELATE_ALL
    onMiss:
      action: NO_OP
